"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const sql = require("mssql");
var config = {
    user: 'sa',
    password: 'Avanade@2018',
    server: 'localhost',
    database: 'Spotify'
};
class Singer {
    async insertSinger(req, res, next) {
        let pool = await sql.connect(config);
        let result = await pool.request()
            .input('name', sql.VarChar(20), req.body.name)
            .input('description', sql.VarChar(20), req.body.description)
            .query('INSERT INTO Singer VALUES (@name, @description)');
        sql.close();
        res.send(200, { "rowsAffected": result.rowsAffected[0] });
        return next();
    }
    async getSingers(req, res, next) {
        let pool = await sql.connect(config);
        let result;
        if (req.params.id) {
            result = await pool.request()
                .input('id', sql.Int, req.params.id)
                .query('SELECT Id, Name, Description FROM Singer WHERE ID = @id');
        }
        else {
            result = await pool.request()
                .query('SELECT Id, Name, Description FROM Singer');
        }
        res.send(result.recordset);
        sql.close();
        return next();
    }
    ;
    async updateSinger(req, res, next) {
        let pool = await sql.connect(config);
        let result = await pool.request()
            .input('id', sql.Int, req.body.Id)
            .input('name', sql.VarChar(20), req.body.name)
            .input('description', sql.VarChar(20), req.body.description)
            .query('UPDATE Singer SET NAME = @name, DESCRIPTION = @description WHERE Id = @id');
        sql.close();
        res.send(200, { "rowsAffected": result.rowsAffected[0] });
        return next();
    }
    async deleteSinger(req, res, next) {
        let pool = await sql.connect(config);
        let result = await pool.request()
            .input('id', sql.Int, req.params.id)
            .query('DELETE Singer WHERE ID = @id');
        sql.close();
        res.send(200, { "rowsAffected": result.rowsAffected[0] });
        return next();
    }
}
exports.Singer = Singer;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2luZ2VyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL3Npbmdlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLDZCQUE2QjtBQUU3QixJQUFJLE1BQU0sR0FBRztJQUNULElBQUksRUFBRSxJQUFJO0lBQ1YsUUFBUSxFQUFFLGNBQWM7SUFDeEIsTUFBTSxFQUFFLFdBQVc7SUFDbkIsUUFBUSxFQUFFLFNBQVM7Q0FDdEIsQ0FBQTtBQUVELE1BQWEsTUFBTTtJQUNSLEtBQUssQ0FBQyxZQUFZLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxJQUFJO1FBQ3BDLElBQUksSUFBSSxHQUFHLE1BQU0sR0FBRyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUVyQyxJQUFJLE1BQU0sR0FBRyxNQUFNLElBQUksQ0FBQyxPQUFPLEVBQUU7YUFDNUIsS0FBSyxDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO2FBQzdDLEtBQUssQ0FBQyxhQUFhLEVBQUUsR0FBRyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQzthQUMzRCxLQUFLLENBQUMsaURBQWlELENBQUMsQ0FBQztRQUU5RCxHQUFHLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDWixHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxFQUFFLGNBQWMsRUFBRSxNQUFNLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUMxRCxPQUFPLElBQUksRUFBRSxDQUFDO0lBQ2xCLENBQUM7SUFFTSxLQUFLLENBQUMsVUFBVSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsSUFBSTtRQUNsQyxJQUFJLElBQUksR0FBRyxNQUFNLEdBQUcsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7UUFFckMsSUFBSSxNQUFNLENBQUM7UUFDWCxJQUFJLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFO1lBQ2YsTUFBTSxHQUFHLE1BQU0sSUFBSSxDQUFDLE9BQU8sRUFBRTtpQkFDeEIsS0FBSyxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDO2lCQUNuQyxLQUFLLENBQUMseURBQXlELENBQUMsQ0FBQztTQUN6RTthQUFNO1lBQ0gsTUFBTSxHQUFHLE1BQU0sSUFBSSxDQUFDLE9BQU8sRUFBRTtpQkFDeEIsS0FBSyxDQUFDLDBDQUEwQyxDQUFDLENBQUM7U0FDMUQ7UUFFRCxHQUFHLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUUzQixHQUFHLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDWixPQUFPLElBQUksRUFBRSxDQUFDO0lBQ2xCLENBQUM7SUFBQSxDQUFDO0lBRUssS0FBSyxDQUFDLFlBQVksQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLElBQUk7UUFDcEMsSUFBSSxJQUFJLEdBQUcsTUFBTSxHQUFHLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBRXJDLElBQUksTUFBTSxHQUFHLE1BQU0sSUFBSSxDQUFDLE9BQU8sRUFBRTthQUM1QixLQUFLLENBQUMsSUFBSSxFQUFFLEdBQUcsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7YUFDakMsS0FBSyxDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO2FBQzdDLEtBQUssQ0FBQyxhQUFhLEVBQUUsR0FBRyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQzthQUMzRCxLQUFLLENBQUMsMkVBQTJFLENBQUMsQ0FBQztRQUV4RixHQUFHLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDWixHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxFQUFFLGNBQWMsRUFBRSxNQUFNLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUMxRCxPQUFPLElBQUksRUFBRSxDQUFDO0lBQ2xCLENBQUM7SUFFTSxLQUFLLENBQUMsWUFBWSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsSUFBSTtRQUNwQyxJQUFJLElBQUksR0FBRyxNQUFNLEdBQUcsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7UUFFckMsSUFBSSxNQUFNLEdBQUcsTUFBTSxJQUFJLENBQUMsT0FBTyxFQUFFO2FBQzVCLEtBQUssQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQzthQUNuQyxLQUFLLENBQUMsOEJBQThCLENBQUMsQ0FBQztRQUUzQyxHQUFHLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDWixHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxFQUFFLGNBQWMsRUFBRSxNQUFNLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUMxRCxPQUFPLElBQUksRUFBRSxDQUFDO0lBQ2xCLENBQUM7Q0FDSjtBQTFERCx3QkEwREMifQ==